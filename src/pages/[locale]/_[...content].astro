---
import { getEntry, type Paths } from '@/scripts/content';
import { loadTranslations, state } from '@/scripts/translate';
import Layout from '@/components/layouts/ContentLayout.astro';
import Icon from 'astro-icon';
import { Show } from 'solid-js';

export { getContentPaths as getStaticPaths } from '@/scripts/content';

const { t, locale } = await loadTranslations(Astro);
const { slug, type } = Astro.props as Paths['props'];

const post = getEntry(slug, type);
const { frontmatter: matter, Content } = post;
---

<Layout title={matter.title}>
  <Show slot="banner" when={locale !== post.locale && locale === 'en'}>
    <div class="rounded border-l-[3px] border-sky-700 bg-sky-200 px-6 py-3 leading-[1.3] text-sky-900 dark:border-sky-200/50 dark:bg-sky-900/50 dark:text-sky-200">
      <p>{t.blog.untranslated}</p>
    </div>
  </Show>
  <Show slot="subtitle" when={post.type === 'post'}>
    <div class="flex gap-6 text-lg text-gray-700 dark:text-gray-200">
      <span class="flex gap-2">
        <Icon name="tabler:calendar" width={20} />
        {post.frontmatter.date?.toLocaleDateString(state.locale, { dateStyle: 'medium' })}
      </span>
      <span class="flex gap-2">
        <Icon name="tabler:file-text" width={20} />
        {Math.round(matter.raw.length / 1000)} min.
      </span>
    </div>
  </Show>
  <Content />
</Layout>
